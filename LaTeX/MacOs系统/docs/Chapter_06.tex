\chapter{总结与展望}
\section{工作总结}
在弱监督（提供图像级标签，需要给出像素级结果）条件下，面对定位分布广泛、尺寸大小不一的疾病标记物这一任务，本文从图像生成的角度，创造性地组合了CNN分类器和判别器，提出了一种新型网络结构。随后在三个数据集上均进行了实验验证，处理了二类问题和多类问题，并与当前流行的卷积神经网络可视化方法做了详尽的比较。从定性分析（热图）和定量分析（P-R曲线及其AUC）两个角度来看，本文提出的方法均取得了目前最佳的性能表现，在保证定位疾病标记物的精确性的同时还不会遗漏难以察觉的微小疾病标记物。本文的工作总结如下：

1）面对图像中分布广泛、尺寸大小不一的疾病标记物，无论是多示例学习、CNN可视化方法还是弱监督目标定位方法，都只能大概定位到疾病标记物的位置，往往会忽略图像中难以察觉的疾病标记物，这是因为多示例学习需要对图像进行取样操作，CNN可视化方法要么需要对特征图上采样（比如，CAM和Grad-CAM），要么只能得到与图像类别相关的判别性区域（比如，激活最大化方法和网络逆转方法），弱监督目标定位方法要么也会涉及到上采样操作，要么直接使用CNN可视化方法产生目标物体的位置。为了精确定位疾病标记物，本文从图像生成的角度出发，避免了对图像的分块操作和上采样操作，极具创造性地组合了CNN分类器和生成对抗网络，提出了一种新颖的网络模型。其中，CNN分类器负责定位并尽量去除疾病标记物，生成对抗网络负责进一步完全去除疾病标记物，并采用CNN分类器和生成对抗网络交替训练的方式来实现以上设想。另外，由于图像中的疾病标记物所占比例极小，故使用L1损失函数来加以约束，从而尽量保证正常区域保持不变。训练结束后，输入图像减去编码器-解码器输出图像就可精确定位疾病标记物。

2）我们首先将本文提出的方法用于处理二类疾病标记物定位问题，相比于卷积神经网络可视化方法，无论是从定性分析还是从定量分析的角度，本文提出的方法的表现都更为出色。与此同时，我们还将本文提出的方法用于处理多类疾病标记物定位问题，在此过程中，由于天然的数据不均衡现象存在和生成对抗网络自身的限制，我们对网络模型、数据加载方式和损失函数均做出了微调。首先，我们将二类交叉熵换成了多类交叉熵损失函数并将CNN分类器输出端扩展到了多个。另外，我们还将所有异常类看做生成对抗网络的假图像输入，这样既避免了额外引入生成对抗网络，又能最大限度减少额外的计算资源开销。通过以上微调，我们成功将本文提出的方法应用到了多类疾病标记物定位任务中，与卷积神经网络可视化方法相比，文本提出的方法同样取得了目前最佳的性能表现，从而证明了本文提出的方法的应用广泛性和鲁棒性。

疾病标记物的自动定位方法不仅为发现更多潜在疾病标记物提供了技术基础，还有助于医生作出更为准确地疾病诊断，为最终的精准医疗提供一种有效的工具。同时，由于本文提出的方法只需要提供图像级标注，这也能够大大降低图像的标注成本。

\section{研究展望}
虽然本文提出的方法，无论是在二类疾病标记物定位任务还是在多类疾病标记物定位任务上，都能取得了目前最佳的性能。但是本文提出的方法还存在以下不足：

% gan训练
1）众所周知，生成对抗网络的训练过程存在震荡现象，而由编码器-解码器与判别器组成的生成对抗网络是本文提出的模型的重要组成部分，虽然WGAN-GP在理论上证明了添加梯度惩罚项可以避免梯度消失与梯度爆炸，但是当实验参数设置不当时，仍然会发生梯度更新过猛的现象，具体表现在随着训练过程的进行，判别器输出分数的绝对值不断增大，最终导致训练GAN失败。

% 图片size大小
2）本文考虑到图片尺寸过大不仅会增加编码器-解码器的模型复杂度（网络深度），还会增加编码器-解码器重建图像的难度与计算资源开销，本文所有实验的输入图像尺寸大小均为$128\times 128$，实际上原始眼底图像的尺寸大小大于$1000\times 1000$，图像尺寸过小同样会导致原始图像中的部分细节纹理信息的丢失和图像质量一定程度的下降，这也限制了本文提出的方法的使用灵活性。

本文提出的方法除了存在以上不足外，本文提出的方法在处理疾病的多样性方面还能从以下思路进行下一步扩展与延伸：

1）无论是二类糖尿病性视网膜病变数据集，还是二类/多类模拟皮肤病病变数据集，其中疾病标记物的共同特点是分布广泛、尺寸大小不一。异常区域的像素总量在整张图像中也都只占了极少一部分（$\le 5\%$），这也是在本文损失函数中加入L1损失约束的主要原因。所以本文接下来的研究内容可以是异常区域占比较大的疾病类型，比如，真实皮肤黑色素瘤病变。对于此类异常区域占比比较大的图像，L1损失约束显然不再适用。因此还需要对损失函数进行相关改进，其中比较好的方案是根据图像中被修改的像素数量来设置惩罚，一旦输入图像中被修改的像素数量超过某个阈值，则施加较大惩罚。否则，不给予惩罚。

2）在本文使用到的数据集中，无论是二类数据集还是多类数据集，总体而言，各个类别之间只是存在轻微数据不均衡，各个类别之间的图像数量之比接近$1:1$。而在临床情况下，很多疾病是非常少见的，比如斑色鱼鳞癣、大疱性表皮松解症等皮肤疾病。如果能在图像中精确定位到这类罕见疾病的疾病标记物，就可以显著提高这些罕见疾病的诊断水平，这将有重大临床意义。不过这种情况下在图像中定位到疾病标记物，除了要面对样本不均衡问题外，很有可能还需要解决小样本问题。

3）本文提出的方法处理的图像均是与皮肤镜图像或者眼底图像相关，这些图像中的疾病标记物与背景相比均是存在颜色、亮度、纹理等直观视觉特征上的区别。与以上图像不同的是，CT影像是灰度图，CT影像中的疾病标记物与背景的区分度更小，比如，在影像学上，CT肺部影像中实性结节和混合性结节对于医生来说也很容易发生混淆。因此，相比较而言，CT影像中的疾病标记物更加难以检测更不用说定位。但是，医院每天将会产生大量CT影像，如果能充分利用这些数据，在CT影像中完成疾病标记物的定位，那么将会大大减轻医生的工作负担，产生较大的实际应用价值。

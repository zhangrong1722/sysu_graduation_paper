\chapter{引言}\label{cha:introduction}
%引言是论文正文的开端，应包括毕业论文选题的背景、目的和意义；对国内外研究现状和相关领域中已有的研究成果的简要评述；介绍本项研究工作研究设想、研究方法或实验设计、理论依据或实验基础；涉及范围和预期结果等。要求言简意赅，注意不要与摘要雷同或成为摘要的注解。
\section{选题背景与意义}
\label{sec:background}
在医学领域，生物标记物通常指常规的生物过程、致病过程或是对治疗干预的药物反应过程的指标，它具有可以被客观测量和评价的特性。其中，医学影像中的视觉生物标记物是放射科医生调查特定疾病的风险，类别和状态的重要指标。临床测量的如血压，血氧饱和度，心率等都被归为生物标记物，影像中如心室大小，颈动脉内膜中层厚度也可看做是生物标记物。医师在诊断过程中，必然会遇到难以诊断的病例，而生物标记物则可以作为判断是否患病的一种有效手段。生物标记物的临床使用中已经被证明具有实用性，并且具有良好的发展前景，生物标记物通常可分为以下四种：

小分子生物标记物：人体内的小分子物质非常多，食物中所含的氨基酸、葡萄糖、无机盐、维生素等均是小分子。这些小分子物质对于为止人体基本生命活动起着至关重要的作用，这些小分子化合物含量过高或者过低表明人体患有某项特定疾病。比如，血液中血糖长期处于较高水平表明极有可能患有糖尿病，低密度脂蛋白（俗称坏胆固醇）含量过高很可能会诱发冠心病。因此，这些小分子化合物在人体中发生的变化（含量变得过高或者高低）可以作为疾病诊断的有效依据。

大分子生物标记物：人体内的大分子物质包括核酸、蛋白质和脂肪等。核酸主要指的是核糖核酸（缩写为RNA）的水平，是部分病毒、类病毒的遗传信息的载体和存在形式。当病毒入侵人体时，人体免疫系统会对病毒做出反应，分泌相关物质杀灭病毒，因而会引起病毒相关RNA水平的变化，因此RNA水平可反映出人体对入侵人体的病毒的反应状态。2020年春节期间我国武汉市集中爆发的肺炎病例确诊也是将冠状病毒的核酸序列对比检验作为诊断依据~\cite{corman2020detection}。蛋白质作为人体生命活动的主要参与者，参与到了生命活动的各个过程中，因此蛋白质也可看做是生物标记物。同理，脂肪作为最重要的能量储备物质、身体的保护层，并且调节人体内分泌平衡，同样可看做是生物标记物。

复合生物标记物：复合生物标记物包括脱氧核糖核酸（缩写为DNA）、DNA-蛋白质、蛋白质之间的复合体等。DNA是生物细胞内遗传信息的存在形式，是生物体不可缺少的一类生物大分子。DNA中不同的碱基排列序列代表了不同的遗传信息，而生物体内碱基由一种变为另外一种的现象称为基因变异（也叫做基因突变）。基因突变是生物体普遍存在的现象。现代医学已经证明，某一类的基因突变和某一类疾病之间存在密切联系。例如，临床统计表明，携带某种变异基因的人患有阿尔兹海默症的几率要高于不携带该种变异基因的人。疾病和基因的之间的关系还能解释有些吸烟的人患病风险却要低于不吸烟的人这一现象。因此，像DNA这种大分子化合物也可看做生物标记物，用于疾病风险预测。

生物种群标记物：生物种群在人体中也大量存在，并在人的生命活动中发挥重要作用。比如，人体肠道中的双歧杆菌能合成多种人体生长发育所必须的维生素，还能利用蛋白质残渣合成氨基酸。我国最新研究也解释了肠道细菌和肥胖之间的关系，认为肥胖可能由细菌引起~\cite{zhou2019xiao}。因此，人体内的生物种群可也反应人体状况，可作为生物标记物。

生物标记物在临床医学中可发挥重要作用，可用于处理疾病诊断、疾病风险预测、疾病类型区分等多个问题。随着对生物标记物的研究越来越深入，更多生物标记物将会被发现并逐步在临床医学中应用，从而使得临床疾病治疗和诊断更加方便、更加快捷、更加准确，更多造福人类社会。

\section{研究现状}
\label{sec:related_work}
近年来，由于生物标记物对于临床医学的最要作用，生物标记物发现任务，最开始是在医学领域提出，常用的方法有蛋白质组学技术~\cite{srinivas2002proteomics}、鸟枪蛋白质组分析~\cite{hu2008salivary} 、靶向代谢组学解析~\cite{griffiths2010targeted}等生化方法。随着电子计算机断层扫描仪（Computed Tomography，缩写为CT）、核磁共振成像（Magnetic Resonance Imaging，缩写为MRI）、X光等成像设备的临床应用，不同疾病的影像数据不断涌现。由于医学影像标注的高昂成本，大量未标注的医学影像数据亟待有效处理与分析。近些年计算机算力的极大提升，加上海量医学影像数据，利用计算机技术从海量影像数据中找到疾病对应的生物标记物的方法呼之欲出。实际上，很多机器学习方法~\cite{huynh2012statistical, he2010stable, mamoshina2018machine, swan2013application}和深度学习方法~\cite{yao2016imaging, zafeiris2018artificial, li2019efficient}已经被提出用于发现生物标记物，在此不再多做赘述。而对于在弱监督条件下的生物标记物定位问题，常见的有多示例学习（Multiple Instance Learning，缩写为MIL）和CNN的可视化这两种解决思路，下面予以阐述。

\subsection{多示例学习}
MIL~\cite{maron1998framework}是一种常见的用于处理弱监督问题的方法。MIL方法通过训练一个二分类器，不仅完成对异常影像的判断任务（异常/正常），而且可粗略定位异常影像中的显著性区域（即待选生物标记物）。因此，MIL方法可解决医学影像领域中的诸多问题，比如，眼底图像中的视网膜神经纤维分割~\cite{manivannan2017subcategory}和数字病理图像中的癌症诊断~\cite{kandemir2014empowering}。给定一张医学影像，根据MIL思想，将单张影像看作示例包，而对单张影像进行分块操作，并将其看作一个个示例。从而将问题转化为在示例包标签已知情况下，找出示例（待选区域）的标签，最终将其中置信度最高的异常示例看作是生物标记物。但是这种方法在生物标记物极其微小，分布极其分散的情况下很容易失效，难以取得比较令人满意的结果。而且从单张图像进行分块也不易操作，分块尺寸过大时，精确度不够，很可能会包括较多正常区域，出现假阳现象；当分块尺寸过小时，很可能会漏掉异常区域，造成漏检现象，还会产生较多示例，大大增大后续训练的计算量和计算复杂度。另外，当处理多类问题时，示例包就会出现多标签，使得问题变得大大复杂。因此，近些年来，这种思路少有人问津。

\subsection{卷积神经网络中的可视化方法}
由于近些年来图形处理器（Graphics Processing Units，缩写为GPU）计算集群的支持，以CNN为代表的深度学习理论蓬勃发展并不断得到关注。在计算机视觉领域，也不断有新提出的网络结构可用于解决在弱监督条件下的生物标记物定位问题。这些方法是通过可视化图像区域，将CNN分类器在预测图像类别时重点关注的区域看作是生物标记物。其中，扰动方法~\cite{zintgraf2017visualizing}对每个可能的局部区域进行遮挡或遮罩，并检查分类器输出的变化，输出的下降量越大，说明在预测图像类时的重要性越高。相比之下，特征激活方法则是在特定卷积层输出的特征映射中，根据激活区域来定位重要的局部区域，如流行的类激活映射(CAM~\cite{zhou2016learning})及其变体Grad-CAM~\cite{selvaraju2017grad}等。近年来，基于CAM的方法在医学图像分析中得到了广泛的应用，如胸部X线图像~\cite{rajpurkar2017chexnet}中肺炎的检测、数字病理图像~\cite{zhang2017mdnet}中膀胱癌的预测、MRI图像~\cite{yang2018visual}中阿尔茨海默病的诊断等。与CAM和Grad-CAM同样作为一种可视化方法，特征图方法~\cite{simonyan2013deep}利用CNN中的梯度信息计算输入图像中的像素点对图像分类结果的重要性分数。在医学影像处理领域中，该方法可用于解决多通道脑部MRI图像中的肿瘤检测~\cite{banerjee2016novel}、脑部MRI图像中的肿瘤体积检测~\cite{mitra2017volumetric}、皮肤镜图像中的异常分割~\cite{jahanifar2018supervised}等诸多问题。

然而，与MIL一样，扰动方法和遮挡方法均是从图像中取块，将最可能是异常的块看作是生物标记物，而生物标记物往往是形状不规则，大小各异的，因而很难实现生物标记物的精确定位。对于特征激活方法和特征图方法，由于在连续卷积作用下特征图通常会不断缩小，因此为了定位到生物标记物，往往需要将卷积输出响应上采样到输入图像尺寸大小。不难想象，采样倍数越大，生物标记物的定位越粗糙。故以上方法都只能粗略定位生物标志物或病变区域，生物标志物的精确定位仍是一个有待解决的问题。


\section{研究内容与主要难点}\label{sec:existing_diffcuities}
\subsection{研究内容}
本文旨在实现在弱监督条件下，对分布不规则的，并且具有不同的形状和大小的生物标记物实现精确定位，为此，本文提出一种新型网络结构，该种网络结构由一个卷积神经分类器、一个生成器和一个判别器组成。其中，输入一张异常图像，生成器的目的在于输出其“正常”版本，因此，通过输入图像中减去输出图像操作，可以很容易地对异常图像中的生物标记物进行定位和分割。为了帮助实现这一目标，一方面，我们在网络结构中添加了一个CNN分类器，通过将生成器的输出与输入的差值分类为正常或异常来指导生成器去除异常图像中的生物标记物。另一方面，为了使生成器的“正常”输出更加接近真实，我们又增加了一个判别器并与生成器一起进行对抗训练，以区分真正的正常和生成器生成的“正常”。需要注意的是，生成器和判别器组成了对抗生成网络~\cite{goodfellow2014generative}。通过对包含真实生物标记物的糖尿病视网膜病变图像和包含模拟生物标记物的模拟皮肤图像进行定性分析和定量分析，发现与基于CAM的方法相比，无论是在二类问题上，还是在多类问题上，本文提出的网络结构在生物标记物的精确定位方面均具有更好的性能。

\subsection{主要难点}\label{sec:difficulties}
实现在弱监督条件下，对分布不规则，并且具有不同形状和大小的生物标记物实现精确定位，临床意义重大，但是存在诸多难点。概括起来主要有以下三个方面：

1）在实验数据方面，医学数据收集就比自然图像要困难。另外，由于要对实验结果进行定量分析，就必须提供金标准。不幸的是，糖尿病视网膜病变数据集作为开源数据集，本身只有图像级标签，并没有像素级标签，因此需要专业医师对数据进行标注。而糖尿病视网膜病变图像上的生物标记物分布十分广泛、形状大小各异，再加上细小生物标记物与背景之间的边界模糊，极易与背景混淆，因此，数据标注代价高昂。另外，视网膜图像上纹理丰富复杂，这也使得弱监督下条件的生物标记物定位问题变得更加困难。

2）在网络训练方面，由于本文网络结构中涉及到三个部分。其中还涉及到对抗生成网络的训练，而我们是想通过图像生成的方式来实现生物标记物的精确定位。因此，对抗生成网络训练起着至关重要的作用。实际上，自2014年对抗生成网络提出以来，其训练过程就存在训练不稳定、梯度消失、模式崩溃等问题，而且损失函数无法指示训练过程和效果。虽然已有一些列改进方案~\cite{mirza2014conditional, radford2015unsupervised, arjovsky2017wasserstein, gulrajani2017improved, mao2017least}，但是上述问题始终没有得到彻底解决。另外，如何将对抗生成网络和CNN分类器组合训练也是一个值得考虑的问题。在这方面，我们是没有直接经验可以借鉴的。

3）在从二类问题推广到多类问题时，首先由于各类样本数量不一定相等或相近。因此，在训练过程中可能会出现类别不平衡问题。另外，由于在训练对抗生成网络时每次迭代判别器只能两个输入端（正例和负例），而异常类却有多个（数量$\geq 2$）。因此，如何组织数据训练对抗生成网络也需要考虑。一种方案是同时增加判别器至多个，但这会大大增加网络训练过程的复杂性和难度，同时会增加GPU等硬件资源的开销。另一种方案是不增加判别器数量，将所有异常类看做一个整体，保证迭代训练对抗生成网络时正例和负例整体数量相等。这样看似能完美解决，但实际上，在正例数量与负例中每一种异常类之间依然存在类别不均衡现象。

鉴于上述三个方面的问题，在弱监督条件下，对分布不规则，并且具有不同形状和大小的生物标记物的精确定位任务仍然比较棘手。

\section{本文的论文结构与章节安排}\label{sec:arrangement}
本文将会用六章的内容，仔细而全面的介绍本文提出的可用于生物标记物的精确定位任务的新型网络模型，经过各章节内容安排如下：

第一章：

第二章

第三章：

第四章：

第五章：

第六章：
{\color{red}{TODO}}
